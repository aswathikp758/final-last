{"ast":null,"code":"import _regeneratorRuntime from\"D:/20-07-23-zip/cart/cart/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/20-07-23-zip/cart/cart/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/20-07-23-zip/cart/cart/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/20-07-23-zip/cart/cart/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/20-07-23-zip/cart/cart/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useSelector}from\"react-redux\";import CartProduct from\"../component/cartProduct\";import emptyCartImage from\"../assest/empty.gif\";import{toast}from\"react-hot-toast\";import{loadStripe}from'@stripe/stripe-js';import{useNavigate}from\"react-router-dom\";import Footer from\"./footer/Footer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Cart=function Cart(){var productCartItem=useSelector(function(state){return state.product.cartItem;});var user=useSelector(function(state){return state.user;});var navigate=useNavigate();var totalPrice=productCartItem.reduce(function(acc,curr){return acc+parseInt(curr.total);},0);var totalQty=productCartItem.reduce(function(acc,curr){return acc+parseInt(curr.qty);},0);//------------------\nvar _useState=useState({id:\"\",email:\"\",status:\"\",totalQty:\"\",totalPrice:\"\"}),_useState2=_slicedToArray(_useState,2),datas=_useState2[0],setDatas=_useState2[1];var handleOnChange=function handleOnChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setDatas(function(preve){return _objectSpread(_objectSpread({},preve),{},_defineProperty({},name,value));});};//-------------------\nvar handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripePromise,res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY);case 2:stripePromise=_context.sent;if(!user.email){_context.next=17;break;}_context.next=6;return fetch(\"\".concat(process.env.REACT_APP_SERVER_DOMIN,\"/checkout-payment\"),{method:\"POST\",headers:{\"content-type\":\"application/json\"},body:JSON.stringify(productCartItem)});case 6:res=_context.sent;if(!(res.statusCode===300)){_context.next=9;break;}return _context.abrupt(\"return\");case 9:_context.next=11;return res.json();case 11:data=_context.sent;console.log(data);toast(\"Redirect to payment gateway...!\");stripePromise.redirectToCheckout({sessionId:data});_context.next=19;break;case 17:toast(\"You have not Login!\");setTimeout(function(){navigate(\"/login\");},1000);case 19:case\"end\":return _context.stop();}},_callee);}));return function handlePayment(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 md:p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg md:text-2xl font-bold text-slate-600\",children:\"Your Cart Items\"}),productCartItem[0]?/*#__PURE__*/_jsxs(\"div\",{className:\"my-4 flex gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full max-w-3xl \",children:productCartItem.map(function(el){return/*#__PURE__*/_jsx(CartProduct,{id:el._id,name:el.name,image:el.image,category:el.category,qty:el.qty,total:el.total,price:el.price},el._id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md  ml-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"bg-blue-500 text-white p-2 text-lg\",children:\"Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full py-2 text-lg border-b\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Total Qty :\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-auto w-32 font-bold\",onChange:handleOnChange,value:totalQty,children:totalQty})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full py-2 text-lg border-b\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Total Price\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"ml-auto w-32 font-bold\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",onChange:handleOnChange,children:\"\\u20B9\"}),\" \",totalPrice]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-red-500 w-full text-lg font-bold py-2 text-white\",onClick:handlePayment,children:\"Payment\"})]})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full justify-center items-center flex-col\",children:[/*#__PURE__*/_jsx(\"img\",{src:emptyCartImage,alt:\"\",className:\"w-full max-w-sm\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-500 text-3xl font-bold\",children:\"Empty Cart\"})]})})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Cart;","map":{"version":3,"names":["React","useState","useSelector","CartProduct","emptyCartImage","toast","loadStripe","useNavigate","Footer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","productCartItem","state","product","cartItem","user","navigate","totalPrice","reduce","acc","curr","parseInt","total","totalQty","qty","_useState","id","email","status","_useState2","_slicedToArray","datas","setDatas","handleOnChange","e","_e$target","target","name","value","preve","_objectSpread","_defineProperty","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripePromise","res","data","wrap","_callee$","_context","prev","next","process","env","REACT_APP_STRIPE_PUBLIC_KEY","sent","fetch","concat","REACT_APP_SERVER_DOMIN","method","headers","body","JSON","stringify","statusCode","abrupt","json","console","log","redirectToCheckout","sessionId","setTimeout","stop","apply","arguments","children","className","map","el","_id","image","category","price","onChange","onClick","src","alt"],"sources":["D:/20-07-23-zip/cart/cart/frontend/src/page/Cart.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport CartProduct from \"../component/cartProduct\";\r\nimport emptyCartImage from \"../assest/empty.gif\"\r\nimport { toast } from \"react-hot-toast\";\r\nimport {loadStripe} from '@stripe/stripe-js';\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Footer from \"./footer/Footer\";\r\n\r\nconst Cart = () => {\r\n  const productCartItem = useSelector((state) => state.product.cartItem);\r\n const user = useSelector(state => state.user)\r\n  const navigate = useNavigate()\r\n\r\n  const totalPrice = productCartItem.reduce(\r\n    (acc, curr) => acc + parseInt(curr.total),\r\n    0\r\n  );\r\n  const totalQty = productCartItem.reduce(\r\n    (acc, curr) => acc + parseInt(curr.qty),\r\n    0\r\n  );\r\n\r\n  //------------------\r\n\r\n  const [datas,setDatas]=useState({\r\n    id:\"\",\r\n    email:\"\",\r\n    status:\"\",\r\n    totalQty:\"\",\r\n    totalPrice:\"\",\r\n   \r\n  })\r\n\r\n  const handleOnChange=(e)=>{\r\n    const {name,value}=e.target\r\n\r\n    setDatas((preve)=>{\r\n      return{\r\n        ...preve,\r\n        [name]:value\r\n      }\r\n\r\n    })\r\n\r\n  }\r\n  //-------------------\r\n\r\n  \r\n  \r\n  const handlePayment = async()=>{\r\n    const stripePromise=await loadStripe(process.env.REACT_APP_STRIPE_PUBLIC_KEY)\r\n \r\n\r\n\r\n      if(user.email){\r\n        \r\n          const res=await fetch(`${process.env.REACT_APP_SERVER_DOMIN}/checkout-payment`,{\r\n            method:\"POST\",\r\n            headers:{\r\n              \"content-type\":\"application/json\"\r\n            },\r\n            body:JSON.stringify(productCartItem)\r\n          })\r\n          \r\n          if(res.statusCode===300) return;\r\n\r\n          const data= await res.json()\r\n          console.log(data)\r\n\r\n          toast(\"Redirect to payment gateway...!\")\r\n  \r\n          stripePromise.redirectToCheckout({sessionId:data})\r\n\r\n     }\r\n      else{\r\n        toast(\"You have not Login!\")\r\n        setTimeout(()=>{\r\n          navigate(\"/login\")\r\n        },1000)\r\n      }\r\n    \r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n    \r\n      <div className=\"p-2 md:p-4\">\r\n        <h2 className=\"text-lg md:text-2xl font-bold text-slate-600\">\r\n          Your Cart Items\r\n        </h2>\r\n\r\n        {productCartItem[0] ?\r\n        <div className=\"my-4 flex gap-3\">\r\n          {/* display cart items  */}\r\n          <div className=\"w-full max-w-3xl \">\r\n            {productCartItem.map((el) => {\r\n              return (\r\n                <CartProduct\r\n                  key={el._id}\r\n                  id={el._id}\r\n                  name={el.name}\r\n                  image={el.image}\r\n                  category={el.category}\r\n                  qty={el.qty}\r\n                  total={el.total}\r\n                  price={el.price}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {/* total cart item  */}\r\n          <div className=\"w-full max-w-md  ml-auto\">\r\n            <h2 className=\"bg-blue-500 text-white p-2 text-lg\">Summary</h2>\r\n            {/* ---------------------------- */}\r\n               {/* {user && user.image ? (\r\n                  <input type=\"text\" onChange={handleOnChange} value={user._id}/>\r\n                  ) : (\r\n                 <input type=\"text\" />\r\n                )}\r\n                 {user && user.image ? (\r\n                  <input type=\"text\" onChange={handleOnChange} value={user.email}/>\r\n                  ) : (\r\n                 <input type=\"text\" />\r\n                )} */}\r\n\r\n            {/* ---------------------------------------------- */}\r\n            <div className=\"flex w-full py-2 text-lg border-b\">\r\n              <p>Total Qty :</p>\r\n              <p className=\"ml-auto w-32 font-bold\" onChange={handleOnChange} value={totalQty}>{totalQty}</p>\r\n            </div>\r\n            <div className=\"flex w-full py-2 text-lg border-b\">\r\n              <p>Total Price</p>\r\n              <p className=\"ml-auto w-32 font-bold\">\r\n                <span className=\"text-red-500\" onChange={handleOnChange}>â‚¹</span> {totalPrice}\r\n              </p>\r\n            </div>\r\n            <button className=\"bg-red-500 w-full text-lg font-bold py-2 text-white\" onClick={handlePayment}>\r\n              Payment\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        : \r\n        <>\r\n          <div className=\"flex w-full justify-center items-center flex-col\">\r\n            <img src={emptyCartImage} alt=\"\" className=\"w-full max-w-sm\"/>\r\n            <p className=\"text-slate-500 text-3xl font-bold\">Empty Cart</p>\r\n          </div>\r\n        </>\r\n      }\r\n      </div>\r\n      <Footer/>\r\n    \r\n    </>\r\n  );\r\n};\r\n\r\nexport default Cart;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}